<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Status â€¢ Intreen</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .pulse{position:relative;display:inline-block;width:10px;height:10px;border-radius:9999px;background:#10b981;box-shadow:0 0 0 rgba(16,185,129,.4);animation:pulse 2s infinite}
    @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(16,185,129,.4)}70%{box-shadow:0 0 0 12px rgba(16,185,129,0)}100%{box-shadow:0 0 0 0 rgba(16,185,129,0)}}
    .bar{height:10px;border-radius:9999px;background:#e2e8f0;overflow:hidden}
    .fill{height:100%;width:0;background:#1d4ed8;transition:width 1.2s ease}
  </style>
</head>
<body class="bg-slate-50 text-slate-900 min-h-screen flex flex-col">
  <header id="site-navbar"></header>
  <main class="flex-grow max-w-7xl mx-auto px-4 py-10 space-y-8">
    <h1 class="text-3xl font-extrabold">Status</h1>
    <p class="text-slate-600">Live status and uptime for Intreen systems.</p>

    <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4" id="status-grid">
      <!-- Cards injected by JS -->
    </div>
  </main>
  <footer class="bg-blue-900 text-white" id="site-footer"></footer>
  <script type="module">
    import { bootLayout } from '/js/layout.js'; bootLayout();
    const services = [
      { name:'LMS',            uptime: 99.98, status:'operational', desc:'Learning Management System' },
      { name:'Public API',     uptime: 99.95, status:'operational', desc:'REST endpoints' },
      { name:'Database',       uptime: 99.90, status:'operational', desc:'Postgres cluster' },
      { name:'Search',         uptime: 99.92, status:'operational', desc:'Site search index' },
      { name:'Payments',       uptime: 99.80, status:'operational', desc:'Checkout processor' },
      { name:'Events Scraper', uptime: 98.60, status:'degraded',    desc:'CaribbeanEvents.com import' },
    ];
    const grid = document.getElementById('status-grid');
    services.forEach((s,i)=>{
      const card = document.createElement('article');
      card.className = 'rounded-2xl bg-white border border-slate-200 p-5 shadow-sm';
      card.innerHTML = `
        <div class="flex items-center justify-between">
          <h3 class="font-bold">${s.name}</h3>
          <span class="flex items-center gap-2 text-sm ${s.status==='operational'?'text-emerald-700':'text-amber-700'}">
            <span class="pulse" style="background:${s.status==='operational'?'#10b981':'#f59e0b'}"></span>
            ${s.status==='operational'?'Operational':'Degraded'}
          </span>
        </div>
        <p class="text-slate-600 mt-1">${s.desc}</p>
        <div class="mt-3 bar"><div class="fill" style="width:0%"></div></div>
        <div class="mt-1 text-sm text-slate-700"><span class="upt">0.00</span>% uptime (30d)</div>
      `;
      grid.appendChild(card);
      // animate
      setTimeout(()=>{
        const fill = card.querySelector('.fill'); const upt = card.querySelector('.upt');
        fill.style.width = s.uptime + '%';
        let cur = 0; const target = s.uptime; const step = ()=>{ cur = Math.min(target, cur + Math.max(0.5, (target-cur)/8)); upt.textContent = cur.toFixed(2); if (cur < target) requestAnimationFrame(step); }; step();
      }, 60*i);
    });
  </script>
</body>
</html>
